# ERA Scripts

–°–∫—Ä–∏–ø—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–æ–π –ø—Ä–æ–µ–∫—Ç–∞ ERA.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

üìñ **[–ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ Ubuntu 24 –¥–ª—è –¥–µ–ø–ª–æ—è](./SERVER_SETUP.md)**

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç:
- –£—Å—Ç–∞–Ω–æ–≤–∫—É Ruby 3.2.2 —á–µ—Ä–µ–∑ rbenv
- –ù–∞—Å—Ç—Ä–æ–π–∫—É PostgreSQL
- –£—Å—Ç–∞–Ω–æ–≤–∫—É Passenger + Nginx
- –ù–∞—Å—Ç—Ä–æ–π–∫—É —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –¥–µ–ø–ª–æ—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –∏ –±—ç–∫–µ–Ω–¥–∞
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é SSL –∏ firewall

## –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

### –î–µ–ø–ª–æ–π

- [`deploy-frontend.sh`](#6-deploy-frontendsh---–¥–µ–ø–ª–æ–π-—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞-–Ω–∞-production-—Å–µ—Ä–≤–µ—Ä) - –î–µ–ø–ª–æ–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –Ω–∞ production
- [`deploy-backend.sh`](#7-deploy-backendsh---–¥–µ–ø–ª–æ–π-–±—ç–∫–µ–Ω–¥–∞-–Ω–∞-production-—Å–µ—Ä–≤–µ—Ä) - –î–µ–ø–ª–æ–π –±—ç–∫–µ–Ω–¥–∞ –Ω–∞ production

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### 1. `start-dev.sh` - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫

–ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã —Å –≤—ã–±–æ—Ä–æ–º –∏–≥—Ä—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏.

```bash
./era_scripts/start-dev.sh
```

**–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –æ–ø—Ü–∏–∏:**
1. –í—ã–±–æ—Ä –∏–≥—Ä—ã (base-game –∏–ª–∏ vassals-and-robbers)
2. –ó–∞–ø—É—Å–∫ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–¥–∞/–Ω–µ—Ç)
3. –°–±–æ—Ä–∫–∞ –Ω–∞ Android —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (–µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –∑–∞–ø—É—Å–∫ –º–æ–±–∏–ª—å–Ω–æ–≥–æ)
4. –í—ã–±–æ—Ä Android —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–µ—Å–ª–∏ –∏—Ö –Ω–µ—Å–∫–æ–ª—å–∫–æ)

**–ß—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:**
- Backend (Rails) –Ω–∞ `http://<IP>:3000`
- Frontend (Vite) –Ω–∞ `http://<IP>:5173`
- Mobile (React Native Metro) - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
- `ACTIVE_GAME` - –∞–∫—Ç–∏–≤–Ω–∞—è –∏–≥—Ä–∞ –¥–ª—è backend
- `VITE_ACTIVE_GAME` - –∞–∫—Ç–∏–≤–Ω–∞—è –∏–≥—Ä–∞ –¥–ª—è frontend
- `ACTIVE_GAME` (–≤ era_native/.env) - –∞–∫—Ç–∏–≤–Ω–∞—è –∏–≥—Ä–∞ –¥–ª—è mobile

### 2. `start-base-game.sh` - –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –±–∞–∑–æ–≤–æ–π –∏–≥—Ä—ã

–ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É —Å –±–∞–∑–æ–≤–æ–π –∏–≥—Ä–æ–π (Era of Change) –±–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤.

```bash
./era_scripts/start-base-game.sh
```

**–û–ø—Ü–∏–∏:**
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–µ–∑ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
./era_scripts/start-base-game.sh --skip-mobile
```

### 3. `start-vassals-game.sh` - –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ Vassals and Robbers

–ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É —Å –∏–≥—Ä–æ–π Vassals and Robbers –±–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤.

```bash
./era_scripts/start-vassals-game.sh
```

**–û–ø—Ü–∏–∏:**
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–µ–∑ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
./era_scripts/start-vassals-game.sh --skip-mobile
```

### 4. `build-prod.sh` - –°–±–æ—Ä–∫–∞ –ø—Ä–æ–¥–∞–∫—à–Ω –≤–µ—Ä—Å–∏–∏ era_native

–°–æ–±–∏—Ä–∞–µ—Ç era_native –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ø—Ä–æ–¥–∞–∫—à–Ω-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ https://epoha.igroteh.su/backend/ —Å Basic Auth).

```bash
./era_scripts/build-prod.sh
```

**–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –æ–ø—Ü–∏–∏:**
1. –¢–∏–ø —Å–±–æ—Ä–∫–∏: Android APK/AAB –∏–ª–∏ iOS
2. –î–ª—è Android: Debug –∏–ª–∏ Release APK, –∏–ª–∏ AAB –¥–ª—è Google Play

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –û–±–Ω–æ–≤–ª—è–µ—Ç `era_native/src/config.ts` —Å –ø—Ä–æ–¥–∞–∫—à–Ω-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- –î–æ–±–∞–≤–ª—è–µ—Ç Basic Auth (Login: Anton, Password: aoFa4-cah)
- –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–±–æ—Ä–∫—É –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ü–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è build-prod.sh –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ dev-—Ä–µ–∂–∏–º—É –∑–∞–ø—É—Å—Ç–∏—Ç–µ `./era_scripts/start-dev.sh`

### 5. `stop-dev.sh` - –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç tmux —Å–µ—Å—Å–∏—é —Å–æ –≤—Å–µ–º–∏ –∑–∞–ø—É—â–µ–Ω–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏.

```bash
./era_scripts/stop-dev.sh
```

### 6. `deploy-frontend.sh` - –î–µ–ø–ª–æ–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –Ω–∞ production —Å–µ—Ä–≤–µ—Ä

–°–æ–±–∏—Ä–∞–µ—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ª–æ–∫–∞–ª—å–Ω–æ –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–π `dist` –Ω–∞ production —Å–µ—Ä–≤–µ—Ä.

```bash
./era_scripts/deploy-frontend.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –≤–µ—Ä—Å–∏–∏ –∏–≥—Ä—ã (base-game –∏–ª–∏ vassals-and-robbers)
2. –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π `.env`
3. –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ `dist` –Ω–∞ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ `rsync`
4. –°–æ–∑–¥–∞–Ω–∏–µ release –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ —Å–∏–º–ª–∏–Ω–∫–∞ `current`
5. –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö releases (–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- –°–µ—Ä–≤–µ—Ä –∑–∞–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `FRONTEND_DEPLOY_SERVER` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `62.173.148.168`)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `deploy`
- –ü—É—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: `/opt/era/era_front`
- Backend URL: `https://epoha.igroteh.su/backend`

**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
./era_scripts/deploy-frontend.sh

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–µ—Ä
FRONTEND_DEPLOY_SERVER=staging.example.com ./era_scripts/deploy-frontend.sh
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –°—É—â–µ—Å—Ç–≤—É–µ—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ Capistrano:
```bash
cd eraofchange
cap production frontend:deploy          # –¥–ª—è base-game
cap production frontend:deploy_vassals # –¥–ª—è vassals-and-robbers
```

### 7. `deploy-backend.sh` - –î–µ–ø–ª–æ–π –±—ç–∫–µ–Ω–¥–∞ –Ω–∞ production —Å–µ—Ä–≤–µ—Ä

–î–µ–ø–ª–æ–∏—Ç –±—ç–∫–µ–Ω–¥ (Rails –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ) –Ω–∞ production —Å–µ—Ä–≤–µ—Ä –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Capistrano.

```bash
./era_scripts/deploy-backend.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –≤–µ—Ä—Å–∏–∏ –∏–≥—Ä—ã (base-game –∏–ª–∏ vassals-and-robbers)
2. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–≤–µ—Ç–∫–∞ `depl`)
3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ Bundler
4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (database.yml, master.key, .env.production)
5. –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–º–ª–∏–Ω–∫–æ–≤ –¥–ª—è shared —Ñ–∞–π–ª–æ–≤ –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
6. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ Passenger
7. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
8. –ó–∞–ø—É—Å–∫ —Å–∏–¥–æ–≤ (–¥–ª—è vassals-and-robbers —Ç–∞–∫–∂–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–∏–¥—ã)
9. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Passenger (systemd)
10. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã–π —Ä–µ–ª–∏–∑ —á–µ—Ä–µ–∑ —Å–∏–º–ª–∏–Ω–∫ `current`
11. –ó–∞–ø—É—Å–∫ Passenger
12. –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö releases (–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- –°–µ—Ä–≤–µ—Ä –∑–∞–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `BACKEND_DEPLOY_SERVER` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `62.173.148.168`)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `deploy`
- –ü—É—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: `/opt/era/eraofchange`
- –í–µ—Ç–∫–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è: `depl`
- Ruby –≤–µ—Ä—Å–∏—è: `3.2.2` (—á–µ—Ä–µ–∑ rbenv)
- Passenger —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ systemd

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã: rbenv, Ruby 3.2.2, PostgreSQL
- –§–∞–π–ª—ã `config/master.key` –∏ `config/database_prod.yml` –¥–æ–ª–∂–Ω—ã —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –æ–Ω–∏ —É–∂–µ –µ—Å—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
- SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É —Å –ø—Ä–∞–≤–∞–º–∏ sudo –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Passenger

**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
./era_scripts/deploy-backend.sh

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–µ—Ä
BACKEND_DEPLOY_SERVER=staging.example.com ./era_scripts/deploy-backend.sh
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –°—É—â–µ—Å—Ç–≤—É–µ—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ Capistrano:
```bash
cd eraofchange
cap production backend:deploy          # –¥–ª—è base-game
cap production backend:deploy_vassals   # –¥–ª—è vassals-and-robbers
```

### 8. `get-ip.sh` - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ IP –∞–¥—Ä–µ—Å–∞

–£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è IP –∞–¥—Ä–µ—Å–∞ —Å–∏—Å—Ç–µ–º—ã.

```bash
source ./era_scripts/get-ip.sh
echo $DEV_IP
```

## Tmux —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å–æ–∑–¥–∞—ë—Ç—Å—è tmux —Å–µ—Å—Å–∏—è `era-dev` —Å —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã–º–∏ –ø–∞–Ω–µ–ª—è–º–∏:

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–Ω–µ–ª–µ–π:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Backend (Rails)           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Frontend   ‚îÇ   Mobile      ‚îÇ
‚îÇ  (Vite)     ‚îÇ (React Native)‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã tmux:**
```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Å—Å–∏–∏
tmux attach -t era-dev

# –û—Ç–∫–ª—é—á–∏—Ç—å—Å—è –æ—Ç —Å–µ—Å—Å–∏–∏ (–Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è –µ—ë)
Ctrl+B, –∑–∞—Ç–µ–º D

# –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –ø–∞–Ω–µ–ª—è–º–∏
Ctrl+B, –∑–∞—Ç–µ–º —Å—Ç—Ä–µ–ª–∫–∏

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Å—Å–∏—é
tmux kill-session -t era-dev
# –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:
./era_scripts/stop-dev.sh
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç/–æ–±–Ω–æ–≤–ª—è—é—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã:

**Backend (eraofchange/):**
- –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `ACTIVE_GAME` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ export –≤ tmux

**Frontend (era_front/):**
- `era_front/.env.development` - —Å `VITE_ACTIVE_GAME`

**Mobile (era_native/):**
- `era_native/.env` - —Å `ACTIVE_GAME`
- `era_native/src/config.ts` - —Å `BACKEND_URL` –∏ `BASIC_AUTH` (—Ç–æ–ª—å–∫–æ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω-—Ä–µ–∂–∏–º–µ)

### –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ:

**Backend:**
```bash
cd eraofchange
ACTIVE_GAME=vassals-and-robbers rails server
```

**Frontend:**
```bash
cd era_front
VITE_ACTIVE_GAME=vassals-and-robbers pnpm dev
```

**Mobile:**
```bash
cd era_native
# –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª —Å ACTIVE_GAME=vassals-and-robbers
npm run android
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –±–∞–∑–æ–≤–æ–π –∏–≥—Ä—ã

```bash
# –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –±–∞–∑–æ–≤–æ–π –∏–≥—Ä—ã
./era_scripts/start-base-game.sh

# –ò–ª–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ
./era_scripts/start-dev.sh
# –í—ã–±—Ä–∞—Ç—å: 1 (base-game)
```

### –ü—Ä–∏–º–µ—Ä 2: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ Vassals and Robbers

```bash
# –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –Ω–æ–≤–æ–π –∏–≥—Ä—ã
./era_scripts/start-vassals-game.sh

# –ò–ª–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ
./era_scripts/start-dev.sh
# –í—ã–±—Ä–∞—Ç—å: 2 (vassals-and-robbers)
```

### –ü—Ä–∏–º–µ—Ä 3: –¢–æ–ª—å–∫–æ backend –∏ frontend (–±–µ–∑ mobile)

```bash
# –ë–∞–∑–æ–≤–∞—è –∏–≥—Ä–∞ –±–µ–∑ mobile
./era_scripts/start-base-game.sh --skip-mobile

# Vassals game –±–µ–∑ mobile
./era_scripts/start-vassals-game.sh --skip-mobile

# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ
./era_scripts/start-dev.sh
# –í—ã–±—Ä–∞—Ç—å –∏–≥—Ä—É, –∑–∞—Ç–µ–º –≤—ã–±—Ä–∞—Ç—å: 2 (–Ω–µ –∑–∞–ø—É—Å–∫–∞—Ç—å mobile)
```

### –ü—Ä–∏–º–µ—Ä 4: –ó–∞–ø—É—Å–∫ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ Android —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ

```bash
./era_scripts/start-dev.sh
# –í—ã–±—Ä–∞—Ç—å –∏–≥—Ä—É
# –í—ã–±—Ä–∞—Ç—å: 1 (–∑–∞–ø—É—Å—Ç–∏—Ç—å mobile)
# –í—ã–±—Ä–∞—Ç—å: 1 (–∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ Android)
# –í—ã–±—Ä–∞—Ç—å –Ω–æ–º–µ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
```

## –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ tmux

–ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Å—Å–∏–∏ (`tmux attach -t era-dev`):

- **Backend (–≤–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å)** - –ª–æ–≥–∏ Rails
- **Frontend (–Ω–∏–∂–Ω—è—è –ª–µ–≤–∞—è)** - –ª–æ–≥–∏ Vite
- **Mobile (–Ω–∏–∂–Ω—è—è –ø—Ä–∞–≤–∞—è)** - –ª–æ–≥–∏ Metro bundler

### –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –ø–∞–Ω–µ–ª—è–º–∏

```
Ctrl+B, –∑–∞—Ç–µ–º ‚Üë  - –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ backend
Ctrl+B, –∑–∞—Ç–µ–º ‚Üì  - –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ frontend/mobile
Ctrl+B, –∑–∞—Ç–µ–º ‚Üê  - –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ frontend
Ctrl+B, –∑–∞—Ç–µ–º ‚Üí  - –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ mobile
```

### –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –≤ –ø–∞–Ω–µ–ª–∏

```
Ctrl+B, –∑–∞—Ç–µ–º [  - –≤–æ–π—Ç–∏ –≤ —Ä–µ–∂–∏–º –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
‚Üë‚Üì –∏–ª–∏ PgUp/PgDn - –ø—Ä–æ–∫—Ä—É—Ç–∫–∞
q                 - –≤—ã–π—Ç–∏ –∏–∑ —Ä–µ–∂–∏–º–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
```

## –ü–æ—Ä—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

- Backend: `3000`
- Frontend: `5173`
- Mobile Metro: `8081` (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

–ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
export BACKEND_PORT=4000
export FRONTEND_PORT=5174
./era_scripts/start-dev.sh
```

## –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è/–æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è:

```
era/
‚îú‚îÄ‚îÄ .env                                   # –û–±—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ era_front/
‚îÇ   ‚îî‚îÄ‚îÄ .env.development                   # VITE_ACTIVE_GAME, VITE_PROXY
‚îú‚îÄ‚îÄ era_native/
‚îÇ   ‚îú‚îÄ‚îÄ .env                               # ACTIVE_GAME, BACKEND_URL
‚îÇ   ‚îî‚îÄ‚îÄ src/config.ts                      # BACKEND_URL (–∞–≤—Ç–æ–≥–µ–Ω)
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **tmux** - –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏—è–º–∏
- **rvm** - –¥–ª—è backend (Ruby)
- **pnpm** - –¥–ª—è frontend (–∏–ª–∏ npm)
- **npm** - –¥–ª—è mobile
- **Android SDK** - –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–∞ Android (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü–æ—Ä—Ç —É–∂–µ –∑–∞–Ω—è—Ç

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é
./era_scripts/stop-dev.sh

# –ò–ª–∏ –Ω–∞–π–¥–∏—Ç–µ –∏ —É–±–µ–π—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ—Ä—Ç—É
lsof -ti:3000 | xargs kill -9
lsof -ti:5173 | xargs kill -9
```

### –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏ Android

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: `adb devices`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ—Ç–ª–∞–¥–∫–∞ –ø–æ USB –≤–∫–ª—é—á–µ–Ω–∞
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å adb: `adb kill-server && adb start-server`

### –ü–ª–∞–≥–∏–Ω –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—ã–±—Ä–∞–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∏–≥—Ä—É –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
2. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –ø–∞–Ω–µ–ª–∏ tmux
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ –∫–∞–∂–¥–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

